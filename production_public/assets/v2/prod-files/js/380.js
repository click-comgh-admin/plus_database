"use strict";(self.webpackChunkwebpackNumbers=self.webpackChunkwebpackNumbers||[]).push([[380],{2892:(e,t,o)=>{o.d(t,{c:()=>a});var r=o(771),s=o(7270),n=o(596),i=o(3600);function a(e=null,t=""){return o=this,a=void 0,u=function*(){const o=(0,i.Ie)(),a=r.t.URLS.AKWAABA_API_BASE_URL+"members/groupings/group"+(null===e?"":"/"+e)+t,l=yield(0,s.d)(a,{method:"GET",headers:{Authorization:"Token "+o.token}},!0);try{return new n.H("get",l)}catch(e){console.error({error:e});let t=l;return t.error=e,new n.H("get",t,!0)}},new((l=void 0)||(l=Promise))((function(e,t){function r(e){try{n(u.next(e))}catch(e){t(e)}}function s(e){try{n(u.throw(e))}catch(e){t(e)}}function n(t){var o;t.done?e(t.value):(o=t.value,o instanceof l?o:new l((function(e){e(o)}))).then(r,s)}n((u=u.apply(o,a||[])).next())}));var o,a,l,u}},9605:(e,t,o)=>{o.d(t,{U:()=>a});var r=o(771),s=o(7270),n=o(596),i=o(3600);function a(e=null,t=""){return o=this,a=void 0,u=function*(){const o=(0,i.Ie)(),a=r.t.URLS.AKWAABA_API_BASE_URL+"members/groupings/sub-group"+(null===e?"":"/"+e)+t,l=yield(0,s.d)(a,{method:"GET",headers:{Authorization:"Token "+o.token}},!0);try{return new n.H("get",l)}catch(e){console.error({error:e});let t=l;return t.error=e,new n.H("get",t,!0)}},new((l=void 0)||(l=Promise))((function(e,t){function r(e){try{n(u.next(e))}catch(e){t(e)}}function s(e){try{n(u.throw(e))}catch(e){t(e)}}function n(t){var o;t.done?e(t.value):(o=t.value,o instanceof l?o:new l((function(e){e(o)}))).then(r,s)}n((u=u.apply(o,a||[])).next())}));var o,a,l,u}},5866:(e,t,o)=>{var r=o(9755),s=o(9392),n=o(1936),i=(o(686),function(e,t,o,r){var s,n=arguments.length,i=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(n<3?s(i):n>3?s(t,o,i):s(t,o))||i);return n>3&&i&&Object.defineProperty(t,o,i),i}),a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let l=class extends s.oi{constructor(){super(...arguments),this.name="",this.label="",this.value=[],this.randomID=Math.floor(12345*Math.random()),this.input_id=this.id+"_"+this.randomID,this.options=[],this.ajaxFetchToken="",this.ajaxFetchUrl=null,this._ajaxHeader=null,this.ajaxFetchProcessResponse=null,this.ajaxFetchUrlParams=[],this.startSearchPage=0,this.startNumber=10,this.rowsPerPage=10,this.totalShowing=10,this.showSelectorLoaded=!1}set ajaxHeader(e){this._ajaxHeader=e,this.requestUpdate()}get ajaxHeader(){return this._ajaxHeader}connectedCallback(){super.connectedCallback(),this.value=Array.isArray(this.value)?this.value:[],setInterval((()=>{void 0===this.selectSelector?(this.selectSelector=document.querySelectorAll("select-input>select[input_id="+this.input_id+"]"),this.$selectSelector=r(this.selectSelector)):this.showDropdownAlt()})),this.options=this.options.map((e=>{const t=e.id;let o=!1;return this.value.forEach((e=>{const r=e.id;o=t===r})),e.selected=o,e}))}render(){return this.multiple?this.required?s.dy`
          <select input_id="${this.input_id}" id="${this.id}" name="${this.name}[]" placeholder="${this.label}" multiple required>
            ${this.options.map((e=>{const t=void 0===e.isSelected?e.selected:e.isSelected;return!0===t||"true"===t?s.dy`
                  <option value="${e.id}" selected>${e.name}</option>
                `:s.dy`
                  <option value="${e.id}">${e.name}</option>
                `}))}
          </select>
        `:s.dy`
          <select input_id="${this.input_id}" id="${this.id}" name="${this.name}[]" placeholder="${this.label}" multiple>
            ${this.options.map((e=>{const t=void 0===e.isSelected?e.selected:e.isSelected;return!0===t||"true"===t?s.dy`
                  <option value="${e.id}" selected>${e.name}</option>
                `:s.dy`
                  <option value="${e.id}">${e.name}</option>
                `}))}
          </select>
        `:this.required?s.dy`
          <select input_id="${this.input_id}" id="${this.id}" name="${this.name}" placeholder="${this.label}" required>
            ${this.options.map((e=>{const t=void 0===e.isSelected?e.selected:e.isSelected;return!0===t||"true"===t?s.dy`
                  <option value="${e.id}" selected>${e.name}</option>
                `:s.dy`
                  <option value="${e.id}">${e.name}</option>
                `}))}
          </select>
        `:s.dy`
          <select input_id="${this.input_id}" id="${this.id}" name="${this.name}" placeholder="${this.label}">
            ${this.options.map((e=>{const t=void 0===e.isSelected?e.selected:e.isSelected;return!0===t||"true"===t?s.dy`
                  <option value="${e.id}" selected>${e.name}</option>
                `:s.dy`
                  <option value="${e.id}">${e.name}</option>
                `}))}
          </select>
        `}firstUpdated(){}formatRepo(e){return e.loading?e.text:r(this.value.map((t=>{const o=Number(e.id)===t.id?"selected='true'":"";return'<option value="'+e.id+'" '+o+">"+e.text+"</option>"})))}formatRepoSelection(e){return e.full_name||e.text}_start(e,t){const o=this;return this.startSearchPage=isNaN(e.page)?0:e.page,this.startSearchPage=0===this.startSearchPage?this.startSearchPage:this.startSearchPage*t,r(".select2-search__field").on("keyup",(function(e){r(o.selectSelector).empty(),o.startSearchPage=0})),o.startSearchPage}showDropdownAlt(){const e=this;let t=this.totalShowing,o=this.startSearchPage;if(!1===this.showSelectorLoaded){if(this.showSelectorLoaded=!0,null===this.ajaxFetchUrl)this.selectSelector.forEach((e=>{r(e).select2({closeOnSelect:!1,placeholder:this.label}),r(e).on("select2:select",(e=>{this.changeAction(e)}))}));else{let s={"Access-Control-Allow-Origin":"*/*",Accept:"application/json, text/plain, */*","Content-Type":"application/json"};for(const e in this.ajaxHeader)s[e]=this.ajaxHeader[e];this.selectSelector.forEach((n=>{r(n).select2({closeOnSelect:!1,ajax:{url:e.ajaxFetchUrl,dataType:"json",delay:250,data:function(s){const n=function(s,n){return o=isNaN(s.page)?0:s.page,o=0===o?o:o*t,r(".select2-search__field").on("keyup",(function(s){r(e.selectSelector).empty(),o=0,t=0})),o}(s),i=function(o,s){let n=isNaN(o.page)?1:o.page+1;return n=0===n?1:n,r(".select2-search__field").on("keyup",(function(o){r(e.selectSelector).empty(),n=0,t=0})),n}(s);let a={search:s.term,start:n,page:i};return e.ajaxFetchUrlParams.forEach((e=>{a[e.param]=e.value})),a},headers:s,processResults:(e,o)=>{const r=null===this.ajaxFetchProcessResponse?this._processResults(e,o):this.ajaxFetchProcessResponse(e,o);return t+=r.results.length,{results:r.results,pagination:{more:t<r.total}}},cache:!0},placeholder:this.label}).on("select2:opening",(e=>{o=0,t=0}))}))}this.querySelectorAll(".select2-container").forEach((e=>{e.setAttribute("style","width: 100% !important; pointer-events: auto !important;")}))}}_processResults(e,t){const o=e;t.page=t.page||0;let r=[];if(!1===o.error){var s=o.data;for(let e=0;e<s.length;e++){const t=s[e],o={id:t.id,text:t.fullName};r.includes(o)||r.push(o)}}return this.totalShowing+=r.length,{results:r,total:o.total,totalShowing:this.totalShowing}}changeAction(e){const t=this.querySelector(`[input_id="${this.input_id}"]`).selectedOptions;let o=[];for(const e of t){let t=e;const r=Number.isNaN(t.value)?0:Number(t.value);o.includes(r)||o.push(r)}this.currentValue=o,this.querySelector(`[input_id="${this.input_id}"]`).setAttribute("currentValue",o)}createRenderRoot(){return this}};l.styles=[s.iv`
      .select2-container {
        pointer-events: auto !important;
      }
    `],i([(0,n.Cb)({type:String}),a("design:type",String)],l.prototype,"name",void 0),i([(0,n.Cb)({type:String}),a("design:type",String)],l.prototype,"label",void 0),i([(0,n.Cb)({type:Array}),a("design:type",Array)],l.prototype,"value",void 0),i([(0,n.Cb)({type:Number}),a("design:type",Number)],l.prototype,"randomID",void 0),i([(0,n.Cb)({type:String}),a("design:type",String)],l.prototype,"input_id",void 0),i([(0,n.Cb)({type:Array}),a("design:type",Array)],l.prototype,"options",void 0),i([(0,n.Cb)({type:Boolean}),a("design:type",Boolean)],l.prototype,"required",void 0),i([(0,n.Cb)({type:String}),a("design:type",String)],l.prototype,"ajaxFetchToken",void 0),i([(0,n.Cb)({type:String}),a("design:type",String)],l.prototype,"ajaxFetchUrl",void 0),i([(0,n.Cb)({attribute:!1}),a("design:type",Object)],l.prototype,"currentValue",void 0),i([(0,n.Cb)({type:Object}),a("design:type",Function)],l.prototype,"ajaxFetchProcessResponse",void 0),i([(0,n.Cb)({type:Array}),a("design:type",Array)],l.prototype,"ajaxFetchUrlParams",void 0),i([(0,n.Cb)({type:Number}),a("design:type",Number)],l.prototype,"startSearchPage",void 0),i([(0,n.Cb)({type:Boolean}),a("design:type",Boolean)],l.prototype,"multiple",void 0),i([(0,n.Cb)({type:Number}),a("design:type",Number)],l.prototype,"startNumber",void 0),i([(0,n.Cb)({type:Number}),a("design:type",Number)],l.prototype,"rowsPerPage",void 0),i([(0,n.Cb)({type:Number}),a("design:type",Number)],l.prototype,"totalShowing",void 0),i([(0,n.Cb)({type:Boolean}),a("design:type",Boolean)],l.prototype,"showSelectorLoaded",void 0),l=i([(0,n.Mo)("select-input")],l)},9283:(e,t,o)=>{o(5248),o(5866);var r=o(428),s=o(7659),n=o(1594),i=o(1848),a=o(2892),l=o(8058),u=o(6455),c=o.n(u),p=o(771),d=o(7270),h=o(596),m=o(8967),g=o(3600),b=function(e,t,o,r){return new(o||(o=Promise))((function(s,n){function i(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},y=o(9605),f=o(2413),v=function(e,t,o,r){return new(o||(o=Promise))((function(s,n){function i(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},S=o(9392),w=o(1936),A=function(e,t,o,r){var s,n=arguments.length,i=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(n<3?s(i):n>3?s(t,o,i):s(t,o))||i);return n>3&&i&&Object.defineProperty(t,o,i),i},k=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},C=function(e,t,o,r){return new(o||(o=Promise))((function(s,n){function i(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};let _=class extends S.oi{constructor(){super(),this._groups=[],this._subgroups=[],this.memberGroups=null,this.memberSubGroups=null}connectedCallback(){const e=Object.create(null,{connectedCallback:{get:()=>super.connectedCallback}});return C(this,void 0,void 0,(function*(){e.connectedCallback.call(this),yield this.getGroups(),yield this.getSubGroups(),yield this.getMemberGroups(),yield this.getMemberSubgroups()}))}disconnectedCallback(){}render(){const e=this.groupsSubgroups,t=e.groups,o=e.subgroups;return S.dy`
      <form method="post" action="#" class="form !my-1" make-general-posts="--awaiting-type--"
        enctype="multipart/form-data">
        <div
          class="flex rounded-lg border border-gray-200 bg-white shadow-md dark:border-gray-700 dark:bg-gray-800 flex-col px-2 mt-1 mb-2">
          <div class="grid grid-cols-1 md:grid-cols-1 lg:grid-cols-2 grid-flow-row gap-4">
            <div class="p-2">
              <h4 class="font-semibold my-2">Select Account Group(s)</h4>
              <select-input name="groups" multiple class="w-full" id="groups" label="Select Account Group(s)"
                .options="${t}" outlined required>
              </select-input>
            </div>
            <div class="p-2">
              <h4 class="font-semibold my-2">Select Account Sub-Group(s)</h4>
              <select-input name="subgroups" multiple class="w-full" id="subgroups" label="Select Account Sub-Group(s)"
                .options="${o}" outlined required>
              </select-input>
            </div>
            <input type="hidden" name="memberId" id="memberId" value="${this.memberId}" />
          </div>
        </div>
        <div
          class="flex rounded-lg border border-gray-200 bg-white shadow-md dark:border-gray-700 dark:bg-gray-800 flex-row my-2 p-1 justify-evenly content-evenly">
          <div class="flex justify-end ">
            <mwc-button class="primary" raised type="submit" label="Update Group(s)" message="Update Group(s)"
              @click="${this.submitGroupsForm}">
            </mwc-button>
          </div>
          <div class="flex justify-end ">
            <mwc-button class="info" raised type="submit" label="Update Sub-Group(s)" message="Update Sub-Group(s)"
              @click="${this.submitSubGroupsForm}">
            </mwc-button>
          </div>
        </div>
      </form>
    `}get groupsSubgroups(){let e=[],t=[];return this._groups.forEach((t=>{var o;let r=!1,s="false";null===(o=this.memberGroups)||void 0===o||o.forEach((e=>{e.groupId.id===t.id&&(r=!0,s="true")}));const n={id:t.id,name:t.group,isSelected:s,selected:r};e.includes(n)||e.push(n)})),this._subgroups.forEach((e=>{var o;let r=!1,s="false";null===(o=this.memberSubGroups)||void 0===o||o.forEach((t=>{t.subgroupId.id===e.id&&(r=!0,s="true")}));const n={id:e.id,name:`${e.groupID.group} => ${e.subgroup}`,isSelected:s,selected:r};t.includes(n)||t.push(n)})),{groups:e,subgroups:t}}firstUpdated(){}getGroups(){return C(this,void 0,void 0,(function*(){const e=yield(0,a.c)();let t=[];if(null===e)t.push({id:0,group:"**NOT FOUND**",date:new Date});else if(!0===e.response.success&&"length"in e.response.data){const o=e.response.data.map((e=>r.e.toGroupModel(JSON.stringify(e))));t=o}const o=[];o.push(...this._groups,...t),this._groups=o}))}getSubGroups(){return C(this,void 0,void 0,(function*(){const e=yield(0,y.U)();let t=[];if(null===e)t.push({id:0,subgroup:"**NOT FOUND**",date:new Date});else if(!0===e.response.success&&"length"in e.response.data){const o=e.response.data.map((e=>n.e.toSubGroupModel(JSON.stringify(e))));t=o}const o=[];o.push(...this._subgroups,...t),this._subgroups=o}))}getMemberGroups(){return C(this,void 0,void 0,(function*(){const e=yield(0,l.t)(null,"?memberId="+this.memberId);if(null===e)this.memberGroups=[];else{const t=Array.isArray(e.paginResponse.results)?e.paginResponse.results:[e.paginResponse.results];this.memberGroups=t.map((e=>s.e.toGroupMemberModel(JSON.stringify(e))))}}))}getMemberSubgroups(){return C(this,void 0,void 0,(function*(){const e=yield(0,f.A)(null,"?memberId="+this.memberId);if(null===e)this.memberSubGroups=[];else{const t=Array.isArray(e.paginResponse.results)?e.paginResponse.results:[e.paginResponse.results];this.memberSubGroups=t.map((e=>i.e.toSubGroupMemberModel(JSON.stringify(e))))}}))}submitGroupsForm(e){return C(this,void 0,void 0,(function*(){const e=this.handleMultitpleSubmitFormSelectors();e.handle("group"),yield function(){return b(this,void 0,void 0,(function*(){const e=(0,g.Ie)(),t=p.t.URLS.AKWAABA_API_BASE_URL+"members/groupings/group-member/bulk",o=document.querySelector('[make-general-posts="members-groupings-group-member-bulk"]'),r=new FormData(o);return c().fire({title:"Update Account Group(s)?",icon:"info",iconColor:"#f97817",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"Cancel",confirmButtonColor:"#f97817",cancelButtonColor:"#ddd",reverseButtons:!0,showLoaderOnConfirm:!0,backdrop:!0,preConfirm:s=>b(this,void 0,void 0,(function*(){return yield(0,d.d)(t,{method:"POST",body:r,headers:{Authorization:"Token "+e.token}},!1).then((e=>{const t=new h.H("post",e,!1,o),r=t.response;if("nameError"in r&&"unknownError"in r&&r.unknownError.length>0){let e=[];r.unknownError.forEach((t=>{t.errors.forEach((o=>{let r={error:t.id+": "+o};"non_field_errors"===t.id&&(r={error:o}),e.push(r)}))}));const t=(0,m.T)(e);c().showValidationMessage(`${t}`)}return t})).catch((e=>{c().showValidationMessage(`${String(e)}`)}))})),allowOutsideClick:()=>!c().isLoading()}).then((e=>{if(e.isConfirmed){let t="Success",o=!1;const r=e.value;if(r instanceof Object){const e=r.response;t=String(e.message),o=r.response.success}o&&c().fire({title:t,icon:o?"success":"error",iconColor:o?"#f97817":"#dc2626",confirmButtonColor:"#f97817"}),o&&setTimeout((()=>{window.location.reload()}),500)}}))}))}(),e.reset("group")}))}submitSubGroupsForm(e){return C(this,void 0,void 0,(function*(){const e=this.handleMultitpleSubmitFormSelectors();e.handle("subgroup"),yield function(){return v(this,void 0,void 0,(function*(){const e=(0,g.Ie)(),t=p.t.URLS.AKWAABA_API_BASE_URL+"members/groupings/sub-group-member/bulk",o=document.querySelector('[make-general-posts="members-groupings-subgroup-member-bulk"]'),r=new FormData(o);return c().fire({title:"Update Account Sub-Group(s)?",icon:"info",iconColor:"#f97817",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"Cancel",confirmButtonColor:"#f97817",cancelButtonColor:"#ddd",reverseButtons:!0,showLoaderOnConfirm:!0,backdrop:!0,preConfirm:s=>v(this,void 0,void 0,(function*(){return yield(0,d.d)(t,{method:"POST",body:r,headers:{Authorization:"Token "+e.token}},!1).then((e=>{const t=new h.H("post",e,!1,o),r=t.response;if("nameError"in r&&"unknownError"in r&&r.unknownError.length>0){let e=[];r.unknownError.forEach((t=>{t.errors.forEach((o=>{let r={error:t.id+": "+o};"non_field_errors"===t.id&&(r={error:o}),e.push(r)}))}));const t=(0,m.T)(e);c().showValidationMessage(`${t}`)}return t})).catch((e=>{c().showValidationMessage(`${String(e)}`)}))})),allowOutsideClick:()=>!c().isLoading()}).then((e=>{if(e.isConfirmed){let t="Success",o=!1;const r=e.value;if(r instanceof Object){const e=r.response;t=String(e.message),o=r.response.success}o&&c().fire({title:t,icon:o?"success":"error",iconColor:o?"#f97817":"#dc2626",confirmButtonColor:"#f97817"}),o&&setTimeout((()=>{window.location.reload()}),500)}}))}))}(),e.reset("subgroup")}))}handleMultitpleSubmitFormSelectors(){return{handle:e=>{document.querySelectorAll('[make-general-posts="--awaiting-type--"]').forEach((t=>{t.hasAttribute("make-general-posts")&&t.setAttribute("make-general-posts",`members-groupings-${e}-member-bulk`)}))},reset:e=>{document.querySelectorAll(`[make-general-posts="members-groupings-${e}-member-bulk"]`).forEach((e=>{e.setAttribute("make-general-posts","--awaiting-type--")}))}}}createRenderRoot(){return this}};_.styles=[S.iv`
   :host { display: block; }
  `],A([(0,w.Cb)({type:Number}),k("design:type",Number)],_.prototype,"memberId",void 0),A([(0,w.Cb)({type:Array}),k("design:type",Array)],_.prototype,"_groups",void 0),A([(0,w.Cb)({type:Array}),k("design:type",Array)],_.prototype,"_subgroups",void 0),A([(0,w.Cb)({type:Array}),k("design:type",Array)],_.prototype,"memberGroups",void 0),A([(0,w.Cb)({type:Array}),k("design:type",Array)],_.prototype,"memberSubGroups",void 0),_=A([(0,w.Mo)("pdb-membership-update-view-group-subgroup"),k("design:paramtypes",[])],_)}}]);
//# sourceMappingURL=380.js.map